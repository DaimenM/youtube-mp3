(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7911:(e,r,t)=>{Promise.resolve().then(t.bind(t,8225))},8225:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>y});var a=t(5155),s=t(2115),n=t(9310),l=t(3463),o=t(9795);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,o.QP)((0,l.$)(r))}let d=s.forwardRef((e,r)=>{let{className:t,variant:s="default",size:n="default",...l}=e;return(0,a.jsx)("button",{className:i("inline-flex items-center justify-center rounded-md font-medium transition-colors","disabled:opacity-50 disabled:pointer-events-none",{"bg-primary text-primary-foreground hover:bg-primary/90":"default"===s,"border border-input bg-background hover:bg-accent":"outline"===s,"hover:bg-accent hover:text-accent-foreground":"ghost"===s},{"h-10 px-4 py-2":"default"===n,"h-9 px-3":"sm"===n,"h-11 px-8":"lg"===n},t),ref:r,...l})});d.displayName="Button";let c=s.forwardRef((e,r)=>{let{className:t,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2","text-sm ring-offset-background file:border-0 file:bg-transparent","file:text-sm file:font-medium placeholder:text-muted-foreground","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring","disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n})});c.displayName="Input";var m=t(6195);let u=e=>{let{children:r}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-1.5 text-center sm:text-left border-b border-green-100 pb-4",children:r})};function f(e){let{isOpen:r,onClose:t,initialFileName:l,downloadUrl:o,onUpdate:f}=e,[x,g]=(0,s.useState)(l),[p,h]=(0,s.useState)(""),[b,N]=(0,s.useState)(""),[v,j]=(0,s.useState)(null),y=async e=>{e.preventDefault();let r=new FormData;r.append("fileName",x),r.append("artistName",p),r.append("albumName",b),r.append("downloadUrl",o),v&&r.append("coverArt",v);try{let e=await fetch("/api/edit",{method:"POST",body:r});if(e.ok){let r=await e.json();r.downloadUrl&&f(r.downloadUrl),t()}else console.error("Failed to edit MP3:",await e.json())}catch(e){console.error("Failed to update MP3:",e)}};return(0,a.jsx)(n.lG,{open:r,onOpenChange:t,children:(0,a.jsxs)(n.Cf,{className:i("bg-white rounded-lg border border-green-100 shadow-xl","p-6 w-full max-w-md mx-auto"),children:[(0,a.jsx)(u,{children:(0,a.jsx)(n.L3,{className:"text-xl font-semibold text-green-700",children:"Edit MP3 Metadata"})}),(0,a.jsxs)("form",{onSubmit:y,className:"space-y-5 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"fileName",className:"text-sm font-medium text-gray-700",children:"File Name (required)"}),(0,a.jsx)(c,{id:"fileName",value:x,onChange:e=>g(e.target.value),required:!0,className:"border-green-200 focus:ring-green-500 focus:border-green-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"artistName",className:"text-sm font-medium text-gray-700",children:"Artist Name"}),(0,a.jsx)(c,{id:"artistName",value:p,onChange:e=>h(e.target.value),className:"border-green-200 focus:ring-green-500 focus:border-green-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"albumName",className:"text-sm font-medium text-gray-700",children:"Album Name"}),(0,a.jsx)(c,{id:"albumName",value:b,onChange:e=>N(e.target.value),className:"border-green-200 focus:ring-green-500 focus:border-green-500"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(m.J,{htmlFor:"coverArt",className:"text-sm font-medium text-gray-700",children:"Cover Art"}),(0,a.jsx)(c,{id:"coverArt",type:"file",accept:"image/jpeg,image/png",onChange:e=>{var r;return j((null===(r=e.target.files)||void 0===r?void 0:r[0])||null)},className:"border-green-200 focus:ring-green-500 focus:border-green-500"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-green-100",children:[(0,a.jsx)(d,{type:"button",variant:"outline",onClick:t,className:"border-green-200 text-green-700 hover:bg-green-50",children:"Cancel"}),(0,a.jsx)(d,{type:"submit",className:"bg-green-600 hover:bg-green-700 transition-colors",children:"Save Changes"})]})]})]})})}let x=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});x.displayName="Card";let g=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:i("flex flex-col space-y-1.5 p-6",t),...s})});g.displayName="CardHeader";let p=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:i("text-2xl font-semibold leading-none tracking-tight",t),...s})});p.displayName="CardTitle";let h=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:i("p-6 pt-0",t),...s})});h.displayName="CardContent";let b=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:i("flex items-center p-6 pt-0",t),...s})});b.displayName="CardFooter";var N=t(4505),v=t(6972);function j(){return(0,a.jsx)("header",{className:"w-full bg-green-600 py-6 shadow-md",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,a.jsx)(v.A,{className:"h-8 w-8 text-white"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-white",children:"YouTube to MP3"})]})})})}function y(){let[e,r]=(0,s.useState)(""),[t,n]=(0,s.useState)(!1),[l,o]=(0,s.useState)(""),[i,m]=(0,s.useState)(""),u=(0,s.useRef)(null);async function y(e,r){try{let t=await fetch(e),a=await t.blob(),s=await fetch("/api/edit"),n=(await s.json()).fileName||r;if("showSaveFilePicker"in window)try{let e=await window.showSaveFilePicker({suggestedName:"".concat(n,".mp3"),types:[{description:"MP3 Audio File",accept:{"audio/mpeg":[".mp3"]}}]}),r=await e.createWritable();await r.write(a),await r.close();return}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;console.log("Falling back to traditional download")}}catch(e){console.error("Download failed:",e)}}let w=async r=>{r.preventDefault(),n(!0),o("");try{u.current=new AbortController;let r=await fetch("/api/convert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e}),signal:u.current.signal});if(r.ok){let e=await r.json();o(e.downloadUrl),m(e.videoTitle)}else console.error("Conversion failed")}catch(e){e instanceof Error&&"AbortError"===e.name?console.log("Conversion cancelled"):console.error("Error:",e)}finally{n(!1),u.current=null}};(0,s.useEffect)(()=>{let e=async()=>{l&&navigator.sendBeacon("/api/convert/cleanup",JSON.stringify({url:l}))};return window.addEventListener("beforeunload",e),()=>{l&&C(l),window.removeEventListener("beforeunload",e)}},[l]);let C=async e=>{try{let r=await fetch("/api/convert",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e})});if(!r.ok){let e=await r.json();throw Error(e.details||"Failed to delete blob")}console.log("Blob deleted successfully:",e)}catch(e){console.error("Failed to delete blob:",e)}},k=async()=>{l&&await C(l),r(""),o(""),m("")},[E,S]=(0,s.useState)(!1);return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsx)(j,{}),(0,a.jsx)("main",{className:"container mx-auto px-4 py-12",children:(0,a.jsxs)(x,{className:"w-full max-w-md mx-auto shadow-xl border-green-100 border",children:[(0,a.jsx)(g,{className:"border-b border-green-100",children:(0,a.jsx)(p,{className:"text-xl text-green-700",children:"Convert Video"})}),(0,a.jsxs)(h,{className:"pt-6",children:[(0,a.jsxs)("form",{onSubmit:w,className:"space-y-4",children:[(0,a.jsx)(c,{type:"text",placeholder:"Enter YouTube video URL",value:e,onChange:e=>r(e.target.value),required:!0,className:"border-green-200 focus:ring-green-500 focus:border-green-500"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(d,{type:"submit",className:"flex-1 bg-green-600 hover:bg-green-700 transition-colors",disabled:t,children:t?(0,a.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 animate-spin"}),"Converting..."]}):"Convert to MP3"}),t&&(0,a.jsx)(d,{type:"button",onClick:()=>{u.current&&(u.current.abort(),u.current=null,n(!1))},className:"bg-red-600 hover:bg-red-700 transition-colors",children:"Cancel"})]})]}),l&&(0,a.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,a.jsx)("p",{className:"text-center text-lg text-gray-800 font-semibold break-words",children:i}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-4",children:[(0,a.jsxs)("a",{href:"#",onClick:e=>{var r;e.preventDefault();let t=(null===(r=l.split("/").pop())||void 0===r?void 0:r.split("?")[0])||"audio.mp3";y(l,t)},className:"inline-flex items-center space-x-2 text-green-600 hover:text-green-700 font-medium",children:[(0,a.jsx)(v.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Download MP3"})]}),(0,a.jsx)(d,{type:"button",onClick:()=>S(!0),className:"bg-blue-600 hover:bg-blue-700 transition-colors text-sm",children:"Edit MP3"}),(0,a.jsx)(d,{type:"button",onClick:k,className:"bg-green-600 hover:bg-green-700 transition-colors text-sm",children:"Convert Another"})]}),(0,a.jsx)(f,{isOpen:E,onClose:()=>S(!1),initialFileName:i,downloadUrl:l,onUpdate:o})]})]}),(0,a.jsx)(b,{className:"border-t border-green-100 justify-center",children:(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Enter a valid YouTube link to convert it to MP3"})})]})})]})}}},e=>{var r=r=>e(e.s=r);e.O(0,[465,441,517,358],()=>r(7911)),_N_E=e.O()}]);